
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

\documentclass[12pt]{article}

% Housekeeping
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{gensymb}  % For celsius degree symbol

\usepackage{cite}
\usepackage{algorithmic}

% Theorem config
\usepackage{ntheorem}
\newtheorem{Law}{Law}

\usepackage{array}

\usepackage{xcolor}
\usepackage{listings}
% \lstset{breaklines}	
\lstset{
numbers=left,
numberstyle=\tiny,
%commentstyle=\color{red!50!green!50!blue!50},
% rulesepcolor=\color{red!20!green!20!blue!20},escapeinside=``,
%xleftmargin=2em,
%xrightmargin=2em,
%aboveskip=1em,
backgroundcolor=\color{red!3!green!3!blue!3},
basicstyle=\small\ttfamily,
stringstyle=\color{purple},
keywordstyle=\color{blue!80}\bfseries,
commentstyle=\color{olive}}

\usepackage{graphicx}
\graphicspath{{./}{./Figure/}}
\usepackage{url}

% This should be put last.
\usepackage{hyperref}



\begin{document}
% And there the document goes.

\title{UCC501 Homework 2 Solutions}
\author{Yanan Xiao\\\url{yxiao@masdar.ac.ae}}
\maketitle{}
% Fuck that.

\section{Energy Scales, CO2  Emissions and Renewables}
\label{sec:question-1}

\subsection{Energy Scales}
\label{sec:energy-scales}

% Life is fucking awesome in United Arab Emirates!
\begin{itemize}
\item Natural gas consumption year 2012: in Billion Cubic Feet:
  2235.169. 
\item For natural gases btu we have
  \begin{equation}
    \label{eq:1}
    1cf\rightarrow 1027 Btu
  \end{equation}
  source:
  \url{http://www.aga.org/KC/ABOUTNATURALGAS/ADDITIONAL/Pages/HowtoMeasureNaturalGas.aspx},
  use MATLAB to convert units, we have
  \begin{equation}
    \label{eq:2}
    2012~Yearly~btu~=~2235.169*10^{9}*1027
  \end{equation}
  Evaluate the equation we get $2.2955*10^{15}~Btu$, divided by
  millions we get $2.2955*10^{9}~MBtu$.
\item From this unit conversion site
  \url{http://www.eia.gov/cfapps/ipdbproject/docs/units.cfm} we have
  \begin{equation}
    \label{eq:3}
    MTOE~=~MBtu * 0.02520 * 10^{-6}
  \end{equation}
  Evaluate the above equation we have $57.8471 MTOE$
\item Similarly we have $1 MBtu~=~1.05506*10^{9} Joules$ and $1
  KWh~=~3.6*10^{6} Joules$, thus
  \begin{equation}
    \label{eq:4}
    2012~Yearly~GKWh~=~2.2955*10^{9} * 1.05506 *10^{9} / (3.6*10^{6} *
    10^{9}) 
  \end{equation}
  Evaluate the above equation we have $672.7527~GKWh$

\end{itemize}

\subsection{CO2 Emissions}
\label{sec:co2-emissions}

\begin{itemize}
\item Assume complete combustion, we have $2235.169~Bcf$ natural gas
  burned in UAE for year 2012. Assume under normal temperature and
  pressure the natural gas is measured, we google the bold texts
  \textbf{natural gas density} and get the following:
\begin{verbatim}
Density
0.656 g/L at 25 °C, 1 atm; 0.716 g/L at 0 °C, 1 atm;
0.42262 g cm−3; (at 111 K)
\end{verbatim}
  Since we assume normal density, we use $\rho~=~0.656 g/L~=~656
  kg/m^{3}$. Thus we have the total mass of CO2 burned in year 2012
  \begin{equation}
    \label{eq:5}
    Mass~of~CH_{4}~=~4.1525*10^{13} kg
  \end{equation}
  Since the background is complete combustion, from chemistry we have
  \begin{equation}
    \label{eq:6}
    CH_{4}~+~2O_{2}~=~ CO_{2}~+~2H_{2}O
  \end{equation}
  and introduce a concept from chemistry, \textbf{molecular weight} we
  have 
  \begin{equation}
    \label{eq:7}
    Mass~of~CO_{2}~=~m_{CH_{4}}*\frac{M_{CO_{2}}}{M_{CH_{4}}}
  \end{equation}
  where $m_{CH_{4}}$ is the mass, the $M_{CH_{4}}$ is the molecular
  weight. This equation is deducted by \textbf{carbon equilibrium}
  under complete combustion.\\
  Evaluate equation (\ref{eq:7}) we have $m_{CO_{2}}~=~1.1419 *
  10^{14} kg$

\end{itemize}

\subsection{Renewables}
\label{sec:renewables-1}

Since we mentioned \textbf{in total} in the question, my answer would
follow the \emph{total} CO2 generated by burning natural gas.
\par
Thus $m1_{co_{2}}~=~0.05 * m_{CO_{2}}$, evaluating it we have
$m1_{co_{2}}~=~5.7097 * 10^{12} kg$.
\begin{itemize}
\item Set the size of such solar plant is $x~MW$, then from
  \textbf{Energy Conservation Law} we have
  \begin{equation}
    \label{eq:8}
    Energy_{solar}~=~Energy_{gas~useful} * 0.05
  \end{equation}
\item For energy generated by a solar plant's lifetime, we have 
  \begin{equation}
    \label{eq:9}
    E_{solar}~=~x * 3.6 * 10^{9} * 1700 * 25
  \end{equation}
\item For energy generated by burning natural gas, we have the
  secondary energy as follows:
  \begin{equation}
    \label{eq:10}
    E_{gas_useful}~=~E_{gas} * 0.40 * 0.92
  \end{equation}
  The $E_{gas}$ can be calculated and/or converted from the
  above. Because we get 2012 yearly gas btu $2.2955 * 10^{15}$,
  convert that to Joule unit
  \begin{equation}
    \label{eq:11}
    E_{gas}~=~2.2955 * 10^{9} * 1.05506 * 10^{9}
  \end{equation}
  Put all these values into (\ref{eq:8}) we have $x~=~291.2624$. Thus
  the size of such a plant is $291.2624\simeq 300~MW$. (I put 300MW
  here for \emph{industrial term}.)
\end{itemize}


\section{Economic Analysis}
\label{sec:economic-analysis}

% Life is fucking awesome in the United Arab Emirates. Let the killing
% begin. 

\subsection{LCOE Calculation}
\label{sec:lcoe-calculation}

From section \ref{sec:question-1} we have the scale of solar farm is
close to 300MW. So to be practical we here use \texttt{Scale =
  300MW}.
\begin{itemize}
\item The whole calculation is done through MATLAB programming,
  therefore, to save pages, we do not repeat the values. We list
  relevant equations here.
% \item Life is fucking awesome in the United Arab Emirates!
\item
  \begin{equation}
    \label{eq:12}
    Total~Capital~Cost~=~Unit~Capital~Cost * Solar~Farm~Scale
  \end{equation}
\item From the values we have, we can use WACC as a \textbf{pretty
    rough} estimation of \textbf{project annual discount rate}. It is
  also listed in the UAE bureau of statistics the expected CPI of next
  5 years, we would like to do another estimate adding this value, if
  possible. 
  \begin{equation}
    \label{eq:13}
    WACC~=~(debt~return*debt~ratio)+(equity~return*equity~ratio)
  \end{equation}
\item The remaining part of question is self-evident in the codes as
  can be seen in the reference link. Following the program, we have
  \begin{equation}
    \label{eq:14}
    Levelized~cost~=~0.2145~\$/KWh
  \end{equation}

\end{itemize}

\subsection{IRR Calculation}
\label{sec:irr-calculation}

% There is something wrong either with the question or with my
% calculation. But I followed the slides so...Well, this is Masdar.
\begin{itemize}
\item IRR means the discount rate which balances income and
  outcome. In \textbf{Financial
    Toolbox}\footnote{\url{http://www.mathworks.com/help/finance/irr.html}}
  of MATLAB, there is the irr function provided.
\item Following the codes implemented in MATLAB in
  \texttt{internal\_rr.m} we have $IRR~=~0.13$.
\end{itemize}


\section{Vehicle Kinetics}
\label{sec:vehicle-kinetics}

\subsection{Propulsion Power}
\label{sec:propulsion-power}

\begin{itemize}
\item From the question we have all the values needed, so just
  evaluate the equation we have $P_{v}~=~6.2321*10^{3}~W$. The whole
  calculation code is shown in reference as well as the link.
\end{itemize}

\subsection{Annual Vehicle Energy Consumption}
\label{sec:annu-vehicle-energy}
% 8.4 Litre/ 100km
% H/C = 2.25
\begin{itemize}
\item For this question I tried to replace the $d$ (distance between
  stops) with $40,000~Km$ but it did not work out as
  expected. Therefore we need to consider this problem in a
  \emph{macro} scale.
\item Since the given mass is $1440Kg$ we can infer that the type of
  engine is a $2.5L$ one. From the manual and
  Wikipedia\footnote{\url{http://en.wikipedia.org/wiki/Toyota_Camry_(XV50)}}
  we have the combined fuel consumption of around
  $8L/100Km$. Moreover, we can get the standard reference density of
  marketable gasoline $0.755Kg/L$. 
\item The rest part is and only is calculation, and that is reflected
  in the source code.
\end{itemize}

\subsection{Abu Dhabi Car Annual}
\label{sec:abu-dhabi-car}

\begin{itemize}
% \item Life is fucking awesome in UAE.
\item The data used in this question can be referred from heat of
  combustion
  Wikipedia\footnote{\url{http://en.wikipedia.org/wiki/Heat_of_combustion}}. We
  use $47.30MJ/Kg$ for gasoline heating value.
\item The process of calculation is a bit tedious but self-evident in
  codes, we can get $1.9046*10^{7}MWh$ energy requirement for an
  estimated 600,000 registered cars in Abu Dhabi. The figure is also
  calculated under full  conversion efficiency.
\item For $CO_{2}$ emissions, we get $4.5236*10^{9}Kg$.
\end{itemize}

\subsection{Panel Installment}
\label{sec:panel-installment}

\begin{itemize}
\item According to all the assumptions and calculations above, we get
  the annual installment of solar power, in $MWh$ is $1.1204*10^{3}MWh$
\end{itemize}

\section{Reference}
\label{sec:reference}

All codes are in the \textbf{public domain}, which means they can be
found at
\url{https://github.com/ProfessorX/UCC501/tree/master/Labs/Homework2} 
\subsection{calc.m}
\label{sec:question-1-1}

\begin{lstlisting}[language=Matlab]
% UCC501 HW2 Calc

%% BTU
NG_cf = 2235.169 * 1e9
NG_btu = NG_cf * 1027
NG_mbtu = NG_btu * 1e-6

%% TOE
NG_toe = NG_mbtu * 0.02520
NG_mtoe = NG_toe * 1e-6

%% GKWh
NG_GKwh = NG_mbtu * 1.05506 *1e9 / (3.6*1e6 * 1e9)
% GKwh = MBtu * 0.94782*1e9 / (3.6*1e6 * 1e9) wrong

% just run the above scripts in MATLAB

%% CH4 mass
NG_cm3 = NG_cf * 0.02832
rho = 656
NG_mass = NG_cm3 * rho
CO2_mass = NG_mass * 44 / 16

%% Renewables
ene_gas = NG_mbtu * 1.05506 * 1e9
ene_gas_useful = ene_gas * 0.40 * 0.92
ene_gas_useful_to_solar = ene_gas_useful * 0.05
ene_solar = ene_gas_useful_to_solar / (3.6 * 1e9 * 1700 * 25)



\end{lstlisting}

% \subsection{eco\_ana.m}
% \label{sec:eco_ana.m}

% \begin{lstlisting}[language=Matlab]
% %% Levelized cost of energy

% % Housekeeping
% solar_scale = 300 * 1e3
% cost_unit_capital = 2700  % in dollars/Kilowatt
% debt_return = 0.03
% debt_ratio = 0.7
% equity_return = 0.15
% equity_ratio = 0.3

% const_year = 1
% oper_year = 25
% n = const_year + oper_year

% annu_maintain_rate = 0.05
% land_unit_scale = 7.9  % this is is per MW
% acre_to_hec = 0.404686
% land_unit_compen = 1800  % this is in year

% % Yet more housekeeping
% annu_hour = 365 * 24  % assume regular 365 days/year

% % Life is fucking awesome in AE
% total_capital_solar = solar_scale * cost_unit_capital
% discount_wacc = debt_return*debt_ratio + equity_return*equity_ratio
% alpha = 1 / (1 + discount_wacc)

% % npv series (for the rate) = sum (a+a^2+a^3+...+a^26)
% npv_rate_series = (alpha * (1-alpha^n))/(1-alpha) % This is the
%                                                   % summing up, you
%                                                   % ESM people!
% npv_total_capital = total_capital_solar / npv_rate_series % This
%                                                           % turned
%                                                           % out to
%                                                           % be annual
% annu_maintain_cost = annu_maintain_rate * total_capital_solar
% total_maintain_cost = annu_maintain_cost * 26  % this may be 25,
%                                                % then we need to
%                                                % re-cal npv series
%                                                % for it.
% npv_total_maintain = total_maintain_cost / npv_rate_series

% solar_land_area = land_unit_scale * 300  % acres and MW
% annu_land_compen = solar_land_area * 1800 * acre_to_hec
% total_land_compen = annu_land_compen * 26
% npv_total_land = total_land_compen / npv_rate_series

% %% Time to pay
% annu_all_cost = npv_total_capital + annu_maintain_cost + ...
%     annu_land_compen
% levelized_cost = annu_all_cost / (annu_hour * solar_scale)

% % rate_discount = 1/1.066
% % series_rate_dr = 
% (rate_discount * (1 - rate_discount^26)) / (1 - rate_discount)

% \end{lstlisting}


\subsection{economic\_analysis.m}
\label{sec:economic_analysis.m}

\begin{lstlisting}[language=Matlab]
%% Levelized cost of energy

% Housekeeping
solar_scale = 300 * 1e3  % in KW
cost_unit_capital = 2700  % in dollars/Kilowatt
debt_return = 0.03
debt_ratio = 0.7
equity_return = 0.15
equity_ratio = 0.3

const_year = 1
oper_year = 25
n = const_year + oper_year

annu_maintain_rate = 0.05
land_unit_scale = 7.9  % this is is per MW
acre_to_hec = 0.404686
land_unit_compen = 1800  % this is in year

% Yet more housekeeping
% annu_hour = 365 * 24  % assume regular 365 days/year
annu_hour = 1700


%% The battle begins
total_capital_solar = solar_scale * cost_unit_capital  % in dollars
discount_wacc = debt_return*debt_ratio + equity_return*equity_ratio
alpha = 1 / (1 + discount_wacc)

solar_land_area = land_unit_scale * 300  % acres and MW
annu_land_compen = solar_land_area * 1800 * acre_to_hec

%% Time to tariff
unit_tariff = 0.3
annu_tariff = unit_tariff * annu_hour * solar_scale

%% TOTO or Total
total_capital = [total_capital_solar, zeros(1, 25)]
total_maintain = 
[0, annu_maintain_rate*total_capital_solar .* ones(1, ...
                                                  25)]
total_land = annu_land_compen .* ones(1, 26)
total_tariff = [0, annu_tariff .* ones(1, 25)]

%% Level, Angel or Demon
total_cost = total_capital +total_land + total_maintain
npv_cost = total_cost .* npv_series
annu_work = solar_scale * annu_hour  % in KWh
total_work = [0, annu_work * ones(1, 25)]
npv_work = total_work .* npv_series

levelized_cost = sum(npv_cost) / sum(npv_work)

% Net return
total_net_return = 
total_tariff - (total_capital + total_land + total_maintain)

irr(total_net_return)  % this requires Finance toolbox

\end{lstlisting}

\subsection{vehicle\_power.m}
\label{sec:vehicle_power.m}

\begin{lstlisting}[language=Matlab]

%% Parameters
velocity = 20
d_trip  = 180 * 10^3
rho_air = 1.2
aero_area = 2.45
co_drag = 0.28
mass_vehicle = 1550
gravity = 9.79
co_rolling = 0.01

% Yet more housekeeping


%% 180Km Propulsion power
power_trip = (mass_vehicle * velocity^3)/(2 * d_trip) + 0.5 * rho_air ...
    * aero_area * co_drag * velocity^3 + mass_vehicle * gravity * ...
    co_rolling * velocity


%% Annual Traveler
d_annual = 40 * 1e3 * 1e3  % in meters
time_annual = 40 * 1e3 / 72 % in hours
% This part is not valid
% $$$ power_annual = (mass_vehicle * velocity^3)/(2 * d_annual) + 0.5 * ...
% $$$     rho_air * aero_area * co_drag * velocity^3 + mass_vehicle * ...
% $$$     gravity * co_rolling * velocity
unit_fuel_con = 0.08  % in L/Km
rho_petrol = 0.755  % Kg/L
cars_abud = 600000

fuel_volume_annu = d_annual * 1e-3 * unit_fuel_con   % convert d_annu to
                                             % Km, result in Litre
fuel_mass_annu = rho_petrol * fuel_volume_annu
heat_petrol_unit = 47.30 * 1e6  % MJ/Kg
heat_petrol_annu = fuel_mass_annu * heat_petrol_unit  % in
                                                      % Joules per car
energy_petrol_annu = heat_petrol_annu / (3.6 * 1e6 * 1e3)  % in MWh


%% Year by year
mass_petrol_carbon = (12 / 14.1) * fuel_mass_annu
mass_carbon_dio = (44 / 12) * mass_petrol_carbon  % Carbon
                                                  % Equilibrium
energy_vehicle_abud = energy_petrol_annu * cars_abud  % in MWh
mass_carbon_dio_abud = mass_carbon_dio * cars_abud  % in Kg
%% How much solar must a man consume?
% Yet more and more housekeeping
solar_flh_uae = 1700

energy_solar_five = 0.5 * energy_vehicle_abud
energy_solar_annu = energy_solar_five / 5
power_solar_annu = energy_solar_annu / solar_flh_uae  % for power,
                                                      % we mean Watts




\end{lstlisting}


\end{document}

TODO: 
#1 Add reference link to your codes since the embedding is ugly.

